# 密钥生成的步骤

## 1. 随机选择两个不相等的质数p和q

选择 61和53。（实际应用中，这两个质数越大，就越难破解。）

## 2. 计算p和q的乘积n

$$n=p\times q=61\times 53=3233$$

n的长度就是密钥长度。3233写成二进制是110010100001，一共有12位，所以这个密钥就是12位。实际应用中，RSA密钥一般是1024位，重要场合则为2048位。

## 3. 计算n的欧拉函数φ(n)

根据公式：

$$ϕ(n)=(p-1)(q-1)$$

则$ϕ(3233)=60*52=3120$

## 4. 随机选择一个整数e，条件是1< e < φ(n)，且e与φ(n) 互质

就在1到3120之间，随机选择了17。（实际应用中，常常选择65537。）

## 5. 计算e对于φ(n)的模反元素d

计算模反元素d

$$ed\equiv1\pmod{ϕ(n)}$$

等价于

$$ed-1=kϕ(n)$$

于是，找到模反元素d，实质上就是对下面这个二元一次方程求解

$$ex+ϕ(n)y=1$$

$$　　17x + 3120y = 1$$

得到一组解为 $(x,y)=(2753,-15)$，即 

$$d=2753$$

## 6. 将n和e封装成公钥，n和d封装成私钥。

n=3233，e=17，d=2753，所以公钥就是 (3233,17)，私钥就是（3233, 2753）。实际应用中，公钥和私钥的数据都采用ASN.1格式表达。