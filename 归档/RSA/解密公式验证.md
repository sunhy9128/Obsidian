# 解密公式验证

$$c^d\equiv m\pmod n$$

因为，根据加密规则 

$$m^e\equiv c\pmod n$$

于是，c可以写成下面的形式：

$$c=m^e-kn$$

代入解密规则

$$(m^e-kn)^d\equiv m\pmod n$$

等同于求证

$$(m^e)^d\equiv m\pmod n$$

由于

$$ed\equiv1\pmod{ϕ(n)}$$

所以

$$ed=h{ϕ(n)}+1$$

将ed代入

$$m^{hϕ(n)+1}\equiv m \pmod n$$

## 若 m、n 互质

$$m^{ϕ(n)}\equiv 1 \pmod n$$

$$(m^{ϕ(n)})^h\equiv 1 \pmod n$$

$$(m^{ϕ(n)})^h\times m\equiv m \pmod n$$

## 若 m、n 不互质

此时，由于n等于质数p和q的乘积，所以m必然等于kp或kq。

以 m = kp为例，此时m与q互质，则根据欧拉定理，下面的式子成立：

$$m^{ϕ(q)}=(kp)^{ϕ(q)}=(kp)^{q-1}\equiv1 \pmod q$$

进一步得到

$$[(kp)^{q-1}]^{h(p-1)}\times kp \equiv kp \pmod q$$

又

$$ed\equiv1\pmod{ϕ(n)}$$

$$ed=hϕ(n)+1$$

$$ϕ(n)=ϕ(p\cdot q)=ϕ(p)\cdot ϕ(q)=(p-1)(q-1)$$

$$ed=hϕ(n)+1=h(p-1)(q-1)+1$$

$$[(kp)^{q-1}]^{h(p-1)}\times kp =(kp)^{ed}\equiv kp \pmod q$$

可写成

$$(kp)^{ed}=tq+kp$$

$$tq=kp(kp^{ed-1}-1)$$

此时 tq必然能被p整除，$t=t'p$

$$(kp)^{ed}=t'pq+kp$$

即

$$m^{ed}=m\pmod n$$

$$m^{hϕ(n)+1}=m\pmod n$$